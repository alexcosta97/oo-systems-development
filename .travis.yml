language: r
python: 2.7
sudo: false
cache:
  directories:
    - $HOME/.cache/pip
#addons:
#  apt:
#    packages:
#    - texlive-latex-extra
#    - dvipng
#    - texlive-latex-recommended
#    - texlive-xetex
#    - latex-xcolor
#    - lmodern
#before_install:
#- sudo add-apt-repository universe
#- sudo apt-get update
#- sudo apt-get install texlive-latex-extra dvipng texlive-latex-recommended texlive-xetex latex-xcolor lmodern
install: pip install Pygments
script:
- mkdir pdf
- bin/appendix > report/appendix.tex
- cd report
- xelatex --synctex=2 --output-directory=../pdf --interaction=nonstopmode -shell-escape -8bit report.tex || true # Tables require regeneration
- xelatex --synctex=2 --output-directory=../pdf --interaction=nonstopmode -shell-escape -8bit report.tex
- cd ..
deploy:
  provider: pages
  skip_cleanup: true
  github_token: $GITHUB_TOKEN
  local_dir: pdf
  target_branch: report
  on:
    branch: master
